{% extends "base.html" %}

{% load food_resize_img %}

{% block title %}Résultats{% endblock %}

{% block content %}
<section class="page-section" id="results">
  <div class="container">
      <div class="col-lg-12 text-center">
        <h1 class="text-uppercase">Vous pouvez remplacer cet aliment par :</h1>
        <hr class="divider my-4">
      </div>
    <div class="row">
        {% for s in substitutes %}
            <div class="col-lg-4 text-center">
                {% if s.nutrition_grade in 'A,B'|make_list %}
                <p class="nutriscore bg-success text-white">
                {% elif s.nutrition_grade in 'C,D'|make_list %}
                <p class="nutriscore bg-warning text-white">
                {% elif s.nutrition_grade == 'E' %}
                <p class="nutriscore bg-danger text-white">
                {% else %}
                <p class="nutriscore">
                {% endif %}
                    {{ s.nutrition_grade }}
                </p>
                <a href="{% url "food:product" substitute_barcode=s.barcode substituted_barcode=substituted.barcode %}">
                    <img class="product-img" src="{{ s.img|resize_img:200 }}" alt="">
                    <p class="product-name">{{ s.name|safe }}</p>
                </a>
                {% if user.is_authenticated %}
                <div class="row">
                    <div class="col-lg-12 text-center save-product">
                        <form class="save" style="display: inline-block;" action="{% url "favorite:save" %}" method="POST">
                            {% csrf_token %}
                            <input type="hidden" name="substitute" value="{{ s.barcode }}"/>
                            <input type="hidden" name="substituted" value="{{ substituted.barcode }}"/>
                            <input type="submit" class="btn btn-primary" value="Sauvegarder" />
                        </form>
                  </div>
                </div>
                <hr class="divider my-1">
                {% endif %}
            </div>
        {% empty %}
        <div class="col-lg-12 ml-auto text-center">
            <div id="no-result" class="alert alert-warning" role="alert"><h2>Pas de substitut trouvé</h2></div>
        </div>
        {% endfor %}

    </div>
</section>


{% endblock %}
